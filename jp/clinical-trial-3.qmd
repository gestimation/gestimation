---
format:
  html:
    toc: true
---
<style>
body {
  margin: 0;
  background: #ffffff;
  color: #2b1f1a;
  font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
  font-size: 18px;
  line-height: 1.55;
}

h1, h2, h3 {
  font-family: "Georgia", "Times New Roman", serif;
  color: #3a2a22;
  font-weight: 600;
}

h3 {
  margin-top: 2.4rem;
}

a {
  color: #8b4a24;
  text-decoration: none;
}
a:hover {
  color: #6f3718;
  text-decoration: underline;
}

.navbar {
  background: #ffffff !important;
  border-bottom: 1px solid #e6e0da;
  margin-bottom: 0 !important;
}
.navbar .navbar-brand,
.navbar .navbar-nav > li > a {
  color: #3a2a22 !important;
  border-bottom: 2px solid transparent;
  padding-bottom: 2px;
}
.navbar .navbar-nav > li > a:hover {
  border-bottom-color: #8b4a24;
}

.hero-text {
  padding: 1.5rem 0;
  color: #3a2a22;
}

.project-card {
  border: 1px solid #e6e0da;
  padding: 1.3rem 1.5rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  background: #ffffff;
  border-radius: 6px;
  margin-bottom: 1.5rem;
}

.about-section {
  border: 1px solid #e6e0da;
  padding: 1.5rem;
  border-radius: 0;
  background: #ffffff;
  margin-top: 2.5rem;
}

.about-section::after {
  content: "";
  display: block;
  clear: both;
}

.author-photo {
  float: left;
  margin-right: 1rem;
  border-radius: 50%;
}

.btn-link {
  display: inline-block;
  border: 1px solid #8b4a24;
  color: #8b4a24;
  padding: 0.4rem 0.9rem;
  font-size: 0.9rem;
  border-radius: 3px;
}
.btn-link:hover {
  background: #8b4a24;
  color: #ffffff;
}

.content-narrow {
  max-width: 1000px;
  margin: 0 auto;
  padding: 1.8rem 1.2rem 2.5rem;
}

.hero-header {
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
}

.hero-header-img {
  width: 100vw;
  height: min(400px, 45vh);
  object-fit: cover;
  object-position: 50% 40%;
  display: block;
}

.dialogue p {
  line-height: 1.7;
}
.dialogue .voice-father p {
  color: #7a3e1a !important;
}
.dialogue .voice-daughter p {
  color: #234f7c !important;
}
.dialogue .voice-daughter,
.dialogue .voice-father {
  margin-bottom: 0.4rem;
}

.serif-text p {
  font-family: "Georgia", "Times New Roman", serif;
}
.serif-block p {
  font-family: "Georgia", "Times New Roman", serif;
  font-size: 0.9em;  line-height: 1.6;
}
</style>

::: hero-header
![](../image/father-daughter.png){.hero-header-img}
:::
# Story and Quiz − Clinical trial III

::: serif-block
　　　　　　　　　　　　　　　　　　　　Keywords: sample size calculation, clinical trial, observational study
:::

------------------------------------------------------------------------

### あれ？何人に調査すればいいんだろう

お父さん「ちょっといいかな」

**私「なに？お父さん、真面目な顔して」**

お父さん「サンプルサイズって計算した？」

**私「サンプルサイズってなんのこと？」**

お父さん「ほら、がんサバイバーの調査するんでしょ。その人数のこと」

**私「ああ、何人に調査するのかっていいたかったの。100人から調査票戻ってきたら上出来かなって思ってるけど」**

お父さん「やっぱり計算してなかったか。がんを手術した後の復職率を推定したいってことでいいの？それなら100人でギリギリだと思う」

**私「いや？前にお父さんにPECOを教えてもらったよね。あれから上司と相談して、ストーマを造設した患者の復職状況を造設しなかった患者と比べることにしたの」**

お父さん「そうなんだ。そうすると計算が違ってくる。100人だと足りないはず」

**私「へ？なんでそんなことわかるのよ。100人に協力してもらうのってたいへんなのよ」**

お父さん「どれだけサンプルサイズが必要なのかについて、統計学的な根拠に基づいて見積もる方法があるんだよ。この表をみてみて。ある書籍から借りてきたものなんだけど（Machin, et al. 2022）」

表1. 割合の推定において指定した 95%信頼区間幅のため必要なサンプルサイズ

| 割合 π | 0.05 | 0.10 | 0.15 | 0.20 |
|--------|-----:|-----:|-----:|-----:|
| 0.01   |  108 |   43 |   25 |   17 |
| 0.02   |  152 |   52 |   29 |   19 |
| 0.03   |  201 |   61 |   33 |   21 |
| 0.04   |  252 |   72 |   37 |   23 |
| 0.05   |  304 |   83 |   41 |   25 |
| 0.06   |  356 |   95 |   46 |   28 |
| 0.07   |  407 |  107 |   50 |   30 |
| 0.08   |  458 |  118 |   55 |   32 |
| 0.09   |  508 |  130 |   60 |   35 |
| 0.10   |  554 |  139 |   62 |   35 |
| 0.11   |  604 |  153 |   69 |   40 |
| 0.12   |  651 |  164 |   74 |   42 |
| 0.13   |  696 |  175 |   78 |   44 |
| 0.14   |  741 |  186 |   83 |   47 |
| 0.15   |  784 |  196 |   87 |   49 |
| 0.16   |  826 |  206 |   92 |   51 |
| 0.17   |  867 |  216 |   96 |   54 |
| 0.18   |  907 |  226 |  100 |   56 |
| 0.19   |  945 |  236 |  104 |   58 |
| 0.20   |  982 |  245 |  108 |   60 |
| 0.25   | 1150 |  286 |  126 |   70 |
| 0.30   | 1288 |  320 |  141 |   78 |
| 0.35   | 1395 |  347 |  152 |   84 |
| 0.40   | 1472 |  366 |  161 |   89 |
| 0.45   | 1518 |  377 |  166 |   92 |
| 0.50   | 1533 |  381 |  167 |   93 |

お父さん「たとえばなんだけどね。復職率を調べたいとするでしょ。そうすると復職率をどれくらい精確に推定できたか表すために、95%信頼区間（confidence interval）をつけることになる」

**私「ふんふん。つけることになるわけね」**

お父さん「仮に復職率が50%だったとしてみよう。そうすると、50%±10%程度の推定精度がほしいよね。ここでいう±の後の数字が、95%信頼区間の幅になるんだ」

**私「ああ、”50%（95%CI 40～60%）”みたいな感じで出てくる、あれのことか。論文でみたことある。40〜60%の場合、95%信頼区間幅は20%ってことね」**

お父さん「そういうこと。表では復職率をπという変数で表しているんだけど、”π=0.5”と”信頼区間幅0.2”に対応する数字をみて。93って書いてあるでしょ。これが必要サンプルサイズ」

**私「どうだろう。復職率ってもっと高くない？手術したときの年齢にもよるけど、たとえば患者さんが50歳前後だったら、80%はいってほしいなあ」**

お父さん「そうなんだ。そうすると復職率80%は非復職率20%と同じことだから、” π=0.2”と”信頼区間幅0.2”のところをみればいい。サンプルサイズは60人」

**私「100人で足りてるじゃん」**

お父さん「いやいやいや、これは復職率の信頼区間からサンプルサイズを計算したからこうなったんだ。「信頼区間アプローチ」といって、主に探索的研究で使うものなんだよ。ストーマ造設ありとなしの復職率を比べるような仮説検証を目指した研究なら、「仮説検定アプローチ」といって、仮説検定の考え方にそってサンプルサイズを計算しないといけない」

**私「仮説検定ってp値のこと？」**

お父さん「そうそう。そっちの話をするなら、p値とαエラー・βエラーの関係を説明しないとだな。この前、どこまで話したっけ？」

**私「p値とかASA声明については聞いたよね。でも、エラーって言葉はでてこなかったな」**

お父さん「じゃあ、話はそこからだね」

::: callout-note
<img src="https://www.notion.so/icons/alert_blue.svg" alt="https://www.notion.so/icons/alert_blue.svg" width="40px"/> **αエラーとβエラー**

これまで、臨床試験JCOG9502（Sasako, et al. 2006）の文脈に沿って、片側p値と両側p値の違いも交えながら、p値について解説してきました。しかし本質的に重要なのは、p値を用いた判断に、どのような合理性があるのか、ということです。

JCOG9502を題材に考えてみましょう。この場合の真実は「LTA群はTH群に比べ全生存期間を延長する効果がある」と「効果がない」の2通りがあるといいました。一方で、試験の結果もp\<0.05とp≥0.05の2通りです。これらを組み合わせは2×2の4通りがあります。

このうち、臨床試験の結果から判断を誤ってしまうケースは2つです。つまり、効果があるのにp≥0.05になってしまうケースと、効果がないのに（帰無仮説が正しいのに）p\<0.05になってしまうケースです。仮説検定では、前者をαエラー（alpha error）、後者をβエラー（beta error）と呼んでいます。また、βエラーを1から引いたものを検出力（power）と呼んでいます。

| 研究結果 | 真に効果がない（帰無仮説） | 真に効果がある（対立仮説） |
|----|----|----|
| 有意差なし（p値≥有意水準） |  | βエラー |
| 有意差あり（p値\<有意水準） | αエラー | 検出力=1-β |

αエラーとβエラーが生じる確率を考えてみましょう。理論的に考えると、サンプルサイズが大きくなるほど、ランダム誤差は小さくなります。αエラーとβエラーも同じで、サンプルサイズが大きいほど小さくなる（判断を誤りにくくなる）性質があります。しかし、2つのエラーはトレードオフの関係にあります。サンプルサイズが一定だと、両方同時に小さくすることはできません。そこで通常は、αエラーを優先して、事前に決めた水準よりも小さく保たれるような判定方式を用います。これが仮説検定であり、事前に決めた水準のことを有意水準と呼びます。実は、p\<0.05で判定することと有意水準を5%と設定することは、同じ意味です。

ややこしいのですが、JCOG9502では症例登録に予定より時間がかかったため、有意水準10%、つまり全生存期間の片側p値を0.1と比べる方式が採用されました。この方式では、LTAに延命効果がなくても、100回に10回はαエラーが生じてしまい、LTAが有効と判定してしまうことになります。つまり、有意水準が5%から10%に高くなると、判断を誤る確率が増える代わりに、サンプルサイズが小さくて済むわけです。
:::

**私「いきなりαとかβとか確率とかいわれてもなあ。ついていけないな」**

お父さん「まずはαエラーとβエラーが臨床試験のどんな結果を表しているか考えると、イメージしやすいかもね。JCOG9502のように試験治療の有効性を検証する試験では、αエラーは標準治療と同じかそれより劣る治療方法が普及してしまうことにつながる。いわば、”αエラー=消費者リスク”といえる。一方で、βエラーは試験治療が本当は有効なのに、開発中止してしまうことを意味する。だから”βエラー=生産者リスク”といわれる。医師の視点で気になるのは、やっぱりαエラーの方だよね」

**私「理屈じゃなくて、数字の実感がないのよ。判断ミスをする確率なんて低い方がいいに決まってるよね。でもどのくらいの確率にするものなの？」**

お父さん「JCOG9502の論文読んだんでしょ。どう書いてあった？」

**私「はいはいみますみます。” The amended sample size was 250, with one-sided alpha error of 0.1 and beta error of 0.2”って書いてある。片側検定で、αエラー0.1、βエラー0.2ってことね。そうすると、予定変更後のサンプルサイズは250人になったんだ」**

お父さん「そういうこと。βエラーは0.1か0.2が一般的かな。米国SWOGの統計家たちは、教科書で”新しい治療法が見つかることはさほど多くないため、我々は原則として90%の検出力を推奨している”って述べている（Green, et al. 2013）。検出力90%はβエラー0.1のことね」

**私「私の研究でもサンプルサイズは250人でよくない？」**

お父さん「雑だけどいい線いってる。大体それくらいになりそうだけど、サンプルサイズの計算結果を表にしてあげるから、ちゃんとそれをみて決めよう。いろんな状況があり得るけど、両側αエラー0.05で、βエラーは0.2（検出力0.8）と0.1（検出力0.9）という設定がもっともよく用いられるから、そのときのサンプルサイズを紹介するね。同じ人数の2つの群を比較することを想定しているから、群ごとの人数はサンプルサイズの半分になる」

::: panel-tabset
### 検出力80%

表2. 2群の生存曲線を比較するためのサンプルサイズ（検出力 80%）\
両側 α=0.05, 1−β=0.8\
※ 数値は「2群合計のサンプルサイズ」（割付け比1:1）

| π2   | π1=0.1 |  0.2 |  0.3 |  0.4 |  0.5 |  0.6 |  0.7 |  0.8 |
|------|-------:|-----:|-----:|-----:|-----:|-----:|-----:|-----:|
| 0.15 |    964 |    — |    — |    — |    — |    — |    — |    — |
| 0.20 |    296 |    — |    — |    — |    — |    — |    — |    — |
| 0.25 |    156 | 1826 |    — |    — |    — |    — |    — |    — |
| 0.30 |    102 |  506 |    — |    — |    — |    — |    — |    — |
| 0.35 |     74 |  246 | 2486 |    — |    — |    — |    — |    — |
| 0.40 |     58 |  152 |  658 |    — |    — |    — |    — |    — |
| 0.45 |     48 |  104 |  308 | 2894 |    — |    — |    — |    — |
| 0.50 |     42 |   78 |  182 |  744 |    — |    — |    — |    — |
| 0.55 |     36 |   62 |  122 |  340 | 3034 |    — |    — |    — |
| 0.60 |     32 |   52 |   90 |  198 |  764 |    — |    — |    — |
| 0.65 |     28 |   42 |   70 |  130 |  342 | 2900 |    — |    — |
| 0.70 |     26 |   38 |   54 |   92 |  194 |  712 |    — |    — |
| 0.75 |     24 |   34 |   38 |   70 |  124 |  312 | 2492 |    — |
| 0.80 |     22 |   30 |   38 |   56 |   86 |  174 |  592 |    — |
| 0.85 |     22 |   26 |   34 |   46 |   66 |  110 |  254 | 1818 |
| 0.90 |     20 |   26 |   30 |   38 |   50 |  136 |  136 |  414 |

### 検出力90%

表3. 2群の生存曲線を比較するためのサンプルサイズ（検出力 90%）\
両側 α=0.05, 1−β=0.9\
※ 数値は「2群合計のサンプルサイズ」（割付け比1:1）

表3. 2群の生存曲線を比較するためのサンプルサイズ（検出力 90%）\
両側 α=0.05, 1−β=0.9\
※ 数値は「2群合計のサンプルサイズ」（割付け比1:1）

| π2   | π1=0.1 |  0.2 |  0.3 |  0.4 |  0.5 |  0.6 |  0.7 |  0.8 |
|------|-------:|-----:|-----:|-----:|-----:|-----:|-----:|-----:|
| 0.15 |   1290 |    — |    — |    — |    — |    — |    — |    — |
| 0.20 |    396 |    — |    — |    — |    — |    — |    — |    — |
| 0.25 |    208 | 2444 |    — |    — |    — |    — |    — |    — |
| 0.30 |    136 |  676 |    — |    — |    — |    — |    — |    — |
| 0.35 |    100 |  330 | 3330 |    — |    — |    — |    — |    — |
| 0.40 |     78 |  202 |  880 |    — |    — |    — |    — |    — |
| 0.45 |     64 |  138 |  412 | 3876 |    — |    — |    — |    — |
| 0.50 |     54 |  104 |  242 |  996 |    — |    — |    — |    — |
| 0.55 |     46 |   82 |  162 |  454 | 4060 |    — |    — |    — |
| 0.60 |     42 |   68 |  120 |  264 | 1022 |    — |    — |    — |
| 0.65 |     38 |   56 |   90 |  172 |  456 | 3880 |    — |    — |
| 0.70 |     34 |   48 |   72 |  124 |  258 |  952 |    — |    — |
| 0.75 |     32 |   42 |   60 |   92 |  166 |  416 | 3336 |    — |
| 0.80 |     30 |   40 |   52 |   74 |  116 |  232 |  796 |    — |
| 0.85 |     28 |   34 |   46 |   60 |   88 |  146 |  338 | 2436 |
| 0.90 |     26 |   32 |   38 |   50 |   68 |  100 |  180 |  548 |
:::

お父さん「ストーマ造設あり・なしの2群があるとして、復職率はそれぞれどれくらいになりそうなの？仮説の値でいいよ」

**私「むずいな。どのくらいなんだろう。なにも不利なことがないなら、手術した後、1年以内に80%は復職してほしいかな。ストーマがあると20%から30%くらいは復職率が下がるんじゃない？調査してみないとわかんないけどね」**

お父さん「なるほど。もし復職状況を生存時間データとして解析するとしたらね。復職できた時点でイベントが発生し、それ以外の患者は打ち切りになる。表2と3は、2群の生存確率を比較するためのもので、生存確率を$\pi_1$と$\pi_2$と表記している。$\pi_1$と$\pi_2$は、がんサバイバー研究でいうとグループごとの”非復職確率”に対応する。つまり復職率が80%と60%だったら、$\pi_1=0.2$と$\pi_2=0.4$になる。この数字を使うってことは、暗黙の裡に、1年間追跡することを想定してるんだけどね。表3の対応箇所をみてみてよ」

**私「202人って書いてある。これが調査しないといけない人数ってこと？」**

お父さん「そういうこと」

**私「もし、202人の全員が1年間で追跡できなかったらどうするの？半年までしか調査できなかったとか」**

お父さん「この表のサンプルサイズは、術後1年間100%追跡できるという前提で計算している。サンプルサイズの計算では、本来、それぞれの群のハザード比や生存期間中央値から必要なイベント数を求め、それを観察するために必要な期間を考慮したうえで人数を決めるんだけど、今回は、2パターンの検出力だけみればいいように状況を単純化している。さっき検出力について説明したでしょ。表3は、検出力90%の検定を行うために必要なサンプルサイズで、表2はそれを検出力80%に緩めたときのもの。表2をみると、検出力80%でよければ、152人に調査すればいいみたいだね」

::: callout-note
<img src="https://www.notion.so/icons/alert_blue.svg" alt="https://www.notion.so/icons/alert_blue.svg" width="40px"/> **サンプルサイズ設計**

研究計画を立てるときには、サンプルサイズを見積もる必要があります。サンプルサイズの計算は大まかにいえば2種類あって、信頼区間アプローチ（たとえば表1）と仮説検定アプローチ（表2と3）を用いることができます。

信頼区間アプローチは、調査や探索的研究で用いられます。このアプローチによって割合を推定するために必要なサンプルサイズを求めるとき、次の数値を設定する必要があります。

-   割合の真値（復職率など）
-   信頼区間幅

もうひとつの仮説検定アプローチは、臨床試験や仮説検証型の研究に適しています。このアプローチでは、以下の3つの要素が最低でも必要です。

-   有意水準（通常5%）
-   検出力（通常80～90%）
-   検出したい効果サイズ（2群間の生存確率の差やハザード比など）

サンプルサイズ設計は、βエラーを制御するという意味で、p値と対になる統計手法といえます。
:::

**私「ふむ。まだよくわかんないな。JCOG9502では、2本の生存曲線を比べてたでしょ」**

お父さん「うん」

**私「いま考えてる統計解析って、ストーマ造設あり・なしと復職状況の関係を調べてたんだよね。以前に聞いた話だと、2値データだとロジスティック回帰、生存時間データだとCox回帰を使うんじゃなかったっけ。生存曲線とCox回帰は別の統計手法じゃない？」**

お父さん「正確にいうとね、生存曲線を比較するためのp値はいくつかの統計手法で計算できる。よく使うのはログランク検定とCox回帰のふたつで、表2と3は、ほんとはログランク検定用なんだけど。Cox回帰を使ったとしても、ストーマ造設あり・なし以外の因子がなければ、ログランク検定とほとんど同じ結果になる。特にサンプルサイズが大きければね」

**私「でも、お父さん、観察研究だと交絡因子を調整しないといけないっていったじゃない」**

お父さん「うん、そういった。でも、交絡因子の影響を前もって予想することは無理だから、表2と3みたいなログランク検定のためのサンプルサイズの公式を、実際には使っている」

**私「お父さん、あとね。表2と3に割付け比1:1って書いてあるでしょ。これって2群の人数が同じってことだよね。**

お父さん「そうだよ、たいていの臨床試験の割付け比は1:1だからね」

**私「でもストーマ保有者って、非保有者より少ないと思うんだけど。半数くらいかな」**

お父さん「調査や観察研究だと、群ごとの人数は同じにならないよね。さっきは、書籍（Machin, et al. 2022）の表を利用させてもらったんだけど、設定が複雑になると、付録のソフトウェアを利用することになる。割付け比を、1:1から1:0.5、1:0.25に変えて、ストーマ保有者が33%、20%のときの計算をしてみよう。検出力80%だと、サンプルサイズは152人から194人、294人になる」

**私「へー。このソフトウェアは調査と臨床試験のためのものなの？」**

お父さん「診断研究やROC曲線にも使えるから、医学研究のほとんどに対応できると思う」

**私「でも、サンプルサイズがすごく増えちゃった。調査する施設を増やすかどうか考えないと」**

::: {.callout-note title="このエピソードに関係するクイズです"}

がん臨床試験では、治療からどの程度生存したかを表す指標として、生存期間中央値（median survival）を求めることがあります。これは生存時間データであるOSから計算される値です。さて、生存期間中央値を報告してよいのは、どのような場合でしょうか？

1.  半数以上の対象者がイベントを起こしたとき
2.  目安としてサンプルサイズが100人以上のとき
3.  すべての対象者が予定された追跡期間を完了したとき
4.  1、2、3すべて誤り
:::

::: {.callout-note collapse="true" title="答えはこちら"}
**正解は1です。**

柔軟に考えてみましょう。生存期間は、日数や年数のような数値データですから、連続データに近い特徴を持っています。連続データでは、中央値（median）は上位50%に相当する値のことですよね。半数以上の対象者がイベントを起こして、生存期間が確定すれば、たとえ打ち切りがあっても、生存期間中央値を求めることができます。もし、予定された追跡期間を全員が完了したとしても、イベントがじゅうぶんに観察されなければ（つまり打ち切りが多かったら）、統計的なテクニックで中央値を計算することはできますが、バイアスが生じる可能性が高くなります。
:::

### Continuation of their story

[Study design I](study-design-1.qmd)

[Study design II](study-design-2.qmd)

[Study design III](study-design-3.qmd)

[Study design III](study-design-4.qmd)

[Study design IV](study-design-5.qmd)

[Clinical trial I](clinical-trial-1.qmd)

[Clinical trial II](clinical-trial-2.qmd)

[Clinical trial III](clinical-trial-3.qmd)

[Epidemiology I](epidemiology-1.qmd)

[Epidemiology II](epidemiology-2.qmd)

[Epidemiology III](epidemiology-3.qmd)

[Epidemiology IV](epidemiology-4.qmd)

[Regression I](logistic-regression-1.qmd)

[Regression II](logistic-regression-2.qmd)

[Regression III](logistic-regression-3.qmd)

[Regression IV](logistic-regression-4.qmd)

[Causal inference I](causal-inference-1.qmd)

[Causal inference II](causal-inference-2.qmd)

[Causal inference III](causal-inference-3.qmd)

[Causal inference IV](causal-inference-4.qmd)

[Publish a paper I](publish-a-paper-1.qmd)

[Publish a paper II](publish-a-paper-2.qmd)

[Publish a paper III](publish-a-paper-3.qmd)

[Publish a paper IV](publish-a-paper-4.qmd)
