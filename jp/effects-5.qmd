---
title: "A First Note on Cox Regression"
description: ""
tags:
  - Effect measure
  - Probability model
  - Survival & competing risks
format:
  html:
    toc: true
---

::: {.hero-header}
![](../image/father-daughter.png){.hero-header-img}
:::

# Effects and Time V − A First Note on Cox Regression

::: {.serif-block .text-right}
Keywords: effect measure, probability model, survival & competing risks
:::

------------------------------------------------------------------------

### Cox回帰はハザード比のモデルというより比例ハザード性のモデル

::::::::::::::::::::::::::::::::: dialogue
::: voice-daughter
私「お父さん、正直にいうと生存曲線とかの数式はわからなかったんだけど、ひとつだけすごく気になったことがあって。それが。ハザード$\lambda_1$と$\lambda_2$の比をとったこの式なの。$HR$は**ハザード比（hazard ratio）**だよね」
:::
::::::::::::::::::::::::::::::::: 

- 指数分布のハザード比
$$
HR=\frac{\lambda_1}{\lambda_2}
$$

::::::::::::::::::::::::::::::::: dialogue
::: voice-daughter
私「この式は**Cox回帰（Cox regression）**でもおなじ？ちがう？」
:::

::: voice-father
お父さん「ごめん、これはCox回帰の式じゃないね。Cox回帰のハザード比はこういう式で表す」
:::
::::::::::::::::::::::::::::::::: 

- Cox回帰のハザード比
$$
HR=\frac{\lambda_1(x)}{\lambda_2(x)}
$$

::::::::::::::::::::::::::::::::: dialogue
::: voice-daughter
私「うん、こんな感じの式になるって思ったんだ。さっき生存関数を教えてくれたのと同じで$x$は時間だよね。ハザード関数は時間とともに変化できて、$\lambda_1(x)$と$\lambda_2(x)$は2群それぞれのハザード関数だっていうことはわかるよ。指数分布ではハザードは定数だった。でも、不思議なのは、どうみても上も下も同じ計算じゃない？割り算しただけ」
:::

::: voice-father
お父さん「ああ、文脈がないとそう読むのが普通かもね。指数分布の式の方はね、*この式以前に*、もともとハザードが一定なんだ。下のCox回帰をみると、$\lambda_1(x)$と$\lambda_2(x)$は時間$x$の関数で、ハザード比だけが一定っていうある種の制約を表している」
:::

::: voice-daughter
私「つまり？」
:::

::: voice-father
お父さん「つまりこの式が出た時点で、はじめて**比例ハザード性**が仮定された、あるいは構造が決まったっていうような文脈でとらえてほしいんだ」
:::

::: voice-daughter
私「やっぱり違うのか。まってね、ということは、この式は`coxph()`の中で$\lambda_1(x)$と$\lambda_2(x)$の比をとっているっていう意味じゃないよね。仮定を置いたってことは、それが成り立たないと困るわけだ。ハザード比の定義でもなさそうな口ぶりだよね」
:::

::: voice-father
お父さん「その通り。比例ハザード性は成り立たないと困るし、この式はハザード比の定義ではない。この式は、単純に2群比較するときのCox回帰のモデルそのものを表している」
:::

::: voice-daughter
私「これがCox回帰の式ね。ロジスティック回帰の式に比べてシンプルすぎて見てて不安になるな。比例ハザード性っていう聞き覚えのある単語で説明されてやっと安心する」
:::

::: voice-father
お父さん「この式は本質的なところしか書いてないからね。Cox回帰のよさはいくつもあるけど、$\lambda_1(x)$と$\lambda_2(x)$はどんな関数でもいいという点が、とても実用的なんだ。比例ハザード性という仮定はあるけどね。その点、指数分布はハザードが定数だから、ずっと融通が利かない。データへの当てはまりが悪いんだ」
:::
:::::::::::::::::::::::::::::::::

### 次のエピソードとRスクリプト

- [Silent Confusions Hidden in Percentages](effects-1.html)
- [Who Is This Percentage About? Target Populations and Attributable Fractions](effects-2.html)
- [When Odds Ratios Approximate Risk Ratios—and When They Fail](effects-3.html)
- [From Risk and Rate to Survival and Hazard](effects-4.html)
- [A First Note on Cox Regression](effects-5.html)
- [After Cox Regression: A Case Study and R Demonstration](effects-6.html)

- [effects.R](../from-coffee-chat-to-r/effects.R)

### 過去のシリーズと用語集

- [A Story of Coffee Chat and Research Hypothesis](study-design-1.html)
- [Reading a Paper over a Cup of Coffee](frequentist-1.html)
- [R Demonstration of Bias in Kaplan-Meier Under Competing Risks](frequentist-4.html)
- [Statistical Terms in Plain Language](glossary.html)
